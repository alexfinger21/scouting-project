<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <title>Scoutify</title>
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Rubik:400,700'>
    <link rel="stylesheet" href="../static/universal.css">
    <link rel="stylesheet" href="../static/data-collection.css">
    <link rel="stylesheet" href="../static/team-summary.css">
    <link rel="stylesheet" href="../static/match-strategy.css">
    <link rel="stylesheet" href="../static/alliance-selector.css">
    <link rel="stylesheet" href="../static/match-listing.css">
    <link rel="stylesheet" href="../static/admin-page.css">
    <link rel="stylesheet" href="../static/rankings.css">
    <link rel="stylesheet" href="../static/team-details.css">
    <link rel="stylesheet" href="../static/alliance-input.css">
    <link rel="icon" href="../static/images/bison-robotics.png" type="image/png">
</head>

<body>

    <%- include("../static/partials/header") %>

        <div id="page-holder">
            

            <%if(assignment != null) {%> <!--Check if user has access-->
                <div id="data-collection-tabs">
                    <button <%- `class= "data-collection-tab ${(selectedPage == "scouting-page" ? "selected" : "")}"`%> page="scouting-page">
                        Scout
                    </button>
                    <button <%- `class= "data-collection-tab ${(selectedPage == "comments-page" ? "selected" : "")}"`%> page="comments-page">
                        Comments
                    </button>
                </div>
            
                <% if(selectedPage == "scouting-page") {%> 
                    <form id="match-number-form" action="/data-collection" method="POST" page="scouting-page" alliance=<%=assignment.gm_alliance%> alliance-position=<%=assignment.gm_alliance_position%>>
                <% }else {%>
                    <form id="match-number-form" action="/data-collection" method="POST" page="scouting-page" alliance=<%=assignment.gm_alliance%> alliance-position=<%=assignment.gm_alliance_position%> style="display:none">
                <%}%>
                
            <!-- MATCH NUMBER-->
            <div class="text-container">   
                <span id="match-number">
                    <%= assignment.match_display%> 
                </span>
            </div>

            <!--ASSIGNED TEAM-->
            <div class="text-container">
                <span class=<%=assignment.team_color %> > <%= assignment.team_display %> </span>
            </div>

            
            <div id="input-scroller">
                <!--PREGAME-->
                <div class="line" id="pre-game">ㅤ</div>
                <div class="input-container">
                    <span>Starting Position</span>
                    <div class="NumberButtonContainer">
                        <button type="button" class="big-button">+</button>
                        <input type="number" name="starting-position" min="1" max="3" value="1">
                        <button type="button" class="big-button">-</button>
                    </div>
                </div>
                <div class="input-container">
                    <span>Robot Preload</span>
                    <div class="NumberButtonContainer">
                        <button type="button" class="big-button">x</button>
                        <input name="robot-preload">
                        <button type="button" class="big-button">
                            <img src="../static/images/checkmark.png" id="button-checkmark">
                        </button>
                    </div>
                </div>
                
                <div class="line" id="autonomous">ㅤ</div>
                
                <div id="auton-container">
                    <canvas id="auton-canvas"></canvas>
                </div>            
                
                <div class="input-container">
                    <span>Leaves Starting Zone</span>
                    <div class="NumberButtonContainer">
                        <button type="button" class="big-button">x</button>
                        <input name="robot-taxies">
                        <button type="button" class="big-button">
                            <img src="../static/images/checkmark.png" id="button-checkmark">
                        </button>
                    </div>
                </div>

                <!--AUTON SCORING GRID-->
                <div class="input-container">
                    <span>Notes scored in Auton</span>
                    <div class="NumberButtonContainer">
                        <button type="button" class="big-button">+</button>
                        <input type="number" name="game-pieces-picked-up-auton" min="0" max="5" value="0">
                        <button type="button" class="big-button">-</button>
                    </div>
                </div>
                <div class="input-container">
                    <span>Robot Auto Scoring</span>
                    <div class="scoring-container" id="auto-scoring">
                        
                    </div>
                </div>
                <div class="input-container">
                    <span>Robot drew tech foul in Auton</span>
                    <div class="NumberButtonContainer">
                        <button type="button" class="big-button">x</button>
                        <input name="auton-tech-foul">
                        <button type="button" class="big-button">
                            <img src="../static/images/checkmark.png" id="button-checkmark">
                        </button>
                    </div>
                </div>

                <!--TELEOP-->
                <div class="line" id="tele-op">ㅤ</div>

                <div class="input-container">
                    <span>Scored in Normal Speaker</span>
                    <div class="NumberButtonContainer">
                        <button type="button" class="big-button">+</button>
                        <input type="number" name="teleop-normal-speaker" min="0" max="5" value="0">
                        <button type="button" class="big-button">-</button>
                    </div>
                </div>
                <div class="input-container">
                    <span>Scored in Amplifier</span>
                    <div class="NumberButtonContainer">
                        <button type="button" class="big-button">+</button>
                        <input type="number" name="teleop-amplifier" min="0" max="5" value="0">
                        <button type="button" class="big-button">-</button>
                    </div>
                </div>
                <div class="input-container">
                    <div class="one-line"><span>Scored in </span> <span style="color: #EEC800">Amplified </span> <span>Speaker</span></div>
                    <div class="NumberButtonContainer">
                        <button type="button" class="big-button">+</button>
                        <input type="number" name="teleop-amplified-speaker" min="0" max="5" value="0">
                        <button type="button" class="big-button">-</button>
                    </div>
                </div>

                <!-- TELEOP SCORING GRID-->
                <div class="input-container">
                    <span>Coopertition Bonus Activated</span>
                    <div class="NumberButtonContainer">
                        <button type="button" class="big-button">x</button>
                        <input name="coopertition-bonus-activated">
                        <button type="button" class="big-button">
                            <img src="../static/images/checkmark.png" id="button-checkmark">
                        </button>
                    </div>
                </div>

                <!--ENDGAME-->
                <div class="line" id="endgame">ㅤ</div>

                <div class="input-container">
                    <span>Robot Endgame</span>
                    <div class="radio-button-container">
                        <input type="radio" id="teleop-unattempted" name="teleop-docking" value="unattempted">
                        <label for="teleop-unattempted">Robot not parked</label>
                        <br>
                        <input type="radio" id="teleop-attempted" name="teleop-docking" value="attempted">
                        <label for="teleop-attempted">Robot parked</label>
                        <br>
                        <input type="radio" id="teleop-docked" name="teleop-docking" value="docked">
                        <label for="teleop-docked">Robot hanging</label>
                        <br>
                        <input type="radio" id="teleop-engaged" name="teleop-docking" value="engaged">
                        <label for="teleop-engaged">Robot hanged + scored trap note</label>
                    </div>
                </div>

                <div class="input-container">
                    <span>Robot has Ground Intake</span>
                    <div class="NumberButtonContainer">
                        <button type="button" class="big-button">x</button>
                        <input name="ground-intake">
                        <button type="button" class="big-button">
                            <img src="../static/images/checkmark.png" id="button-checkmark">
                        </button>
                    </div>
                </div>

                <div class="input-container">
                    <span>Robot passed under the stage</span>
                    <div class="NumberButtonContainer">
                        <button type="button" class="big-button">x</button>
                        <input name="passed-under-stage">
                        <button type="button" class="big-button">
                            <img src="../static/images/checkmark.png" id="button-checkmark">
                        </button>
                    </div>
                </div>
                
                <div class="input-container">
                    <span>Robot Fumbles Notes (multiple select)</span>
                    <div class="radio-button-container">
                        <input type="checkbox" id="fumbles-cones-n/a" name="fumbles-cones" value="n/a">
                        <label for="fumbles-rarely">Rarely fumbles notes</label>
                        <br>
                        <input type="checkbox" id="fumbles-cones-often" name="fumbles-cones" value="often">
                        <label for="fumbles-intake">Failed to intake note >3x</label>
                        <br>
                        <input type="checkbox" id="fumbles-cones-sometimes" name="fumbles-cones" value="sometimes">
                        <label for="fumbles-speaker">Misses speaker shot >3x </label>
                        <br>
                        <input type="checkbox" id="fumbles-cones-sometimes" name="fumbles-cones" value="sometimes">
                        <label for="fumbles-amplifier">Misses amplifier shot >3x </label>
                        
                    </div>
                </div>

                <div class="input-container">
                    <span>Robot Shooting Position</span>
                    <div class="radio-button-container">
                        <input type="radio" id="fumbles-cones-n/a" name="fumbles-cones" value="n/a">
                        <label for="fumbles-cones-n/a">Subwoofer only</label>
                        <br>
                        <input type="radio" id="fumbles-cones-often" name="fumbles-cones" value="often">
                        <label for="fumbles-cones-often">Can shoot into speaker from any position</label>
                        <br>
                        <input type="radio" id="fumbles-cones-sometimes" name="fumbles-cones" value="sometimes">
                        <label for="fumbles-cones-sometimes">Missed shot >3x </label>
                        <br>
                        <input type="radio" id="fumbles-cones-rarely" name="fumbles-cones" value="rarely">
                        <label for="fumbles-cones-rarely">Both</label>
                        <br>
                    </div>
                </div>

                <div class="input-container">
                    <span>Additional Comments</span>
                    <div id="comments-container">
                        <textarea rows="5" cols="33"></textarea>
                    </div>
                </div>
            </div>
            
            <button type="submit" id="data-submit" class="big-button">Save</button>

        </form>

                <% if(selectedPage == "comments-page") {%>
                    <form id="comments-page" page="comments-page">
                <% }else {%>
                    <form id="comments-page" page="comments-page" style="display: none">
                <%}%> 
                
                <% } else {%>
                    
                    <div id="data-collection-tabs">
                        <button class="data-collection-tab" page="scouting-page">
                            Scout
                        </button>
                        <button class="data-collection-tab selected" page="comments-page">
                            Comments
                        </button>
                    </div>

                    <form page="scouting-page" style="display:none">
                        <p id="access-denied">A match isn't running or you aren't assigned to scout</p>
                    </form>

                    <form id="comments-page" page="comments-page">
                <% } %>

                <!--Everything under here is comments page-->
                <div class="small-input-container" id="select-match">
                    <label id="match-comment-label" for="select-match"><b>Match:</b></label>
                    <select id="match-comment-selector" name="select-match">
                        <% for(let i = 0; i < matches.length; i++) { %>
                            <%if(matches[i].gm_number == lastMatch) {%>
                                <option selected>
                                    <%= matches[i].gm_number %>
                                </option>
                            <%} else {%>
                                <option>
                                    <%= matches[i].gm_number %>
                                </option>
                            <%}%>
                        <% } %>
                    </select>
                </div>

                <div id="comments-scroller">
                    <% for(let i = 0; i < 3; i++) {%> 
                        <div class="input-container ">
                            <div class="comments-info">
                                <span class="comments-team red" <%- `alliance=${matchup[i].gm_alliance} pos=${matchup[i].gm_alliance_position}`%>>
                                    <%=matchup[i].team_master_tm_number + " " + matchup[i].tm_name%>
                                </span>
                            </div>
                            <textarea class="comments-text" rows="5" cols="33"></textarea>
                        </div>
                    <%}%>
                    <% for(let i = 3; i < 6; i++) {%> 
                        <div class="input-container ">
                            <div class="comments-info">
                                <span class="comments-team blue" <%- `alliance=${matchup[i].gm_alliance} pos=${matchup[i].gm_alliance_position}`%>>
                                    <%=matchup[i].team_master_tm_number + " " + matchup[i].tm_name%>
                                </span>
                            </div>
                            <textarea class="comments-text" rows="5" cols="33"></textarea>
                        </div>
                    <%}%>
                </div>

                

                <button id="save-comments" class="big-button">Save</button>

            </div>

            <!--Comments page ends-->

            </div>

        <%- include("../static/partials/footer") %>

</body>

</html>
